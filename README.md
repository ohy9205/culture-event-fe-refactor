## 서울시 문화행사 정보를 보여주는 사이드 프로젝트를 리팩토링합니다.

> https://www.seoul-event-info.com
>
> 테스트계정 : test@test.com / 1111

# as-is

- ### **중복 코드 문제**
    - fetch API 사용 코드, response 처리 코드가 컴포넌트마다 중복됨.
    - 접근 권한 체크 코드가 페이지마다 중복됨.
    - form을 사용하는 컴포넌트는 많지만 세부 기능, 입력 항목 차이로 코드를 매번 재작성함.
- ### **낮은 확장성과 재사용성**
    - 재사용성 및 확장성을 위해 로직을 custom hooks으로 분리했으나 여전히 특정 컴포넌트에 한정된 사용성을 가짐.
    - UI에 약간의 차이만 있더라도 코드를 매번 새로 작성 함.
- ### **비효율적인 API 호출**
    - 로그인 유무 검사 시  `getUserMe()` API 호출. 로그인을 안했으면 401에러 로그가 발생. 이후 권한 체크 상황이 많아지면 서버 부하 생길 수 있음.
    - 찜 버튼을 토글하면 해당 아이템을 내가 찜 했는지 판단하기 위해 `getMyLikes()` 를 호출함. 버튼 클릭시마다 api를 두개씩 호출하므로 서버 부하 생길 수 있음.
- ### **성능 및 최적화 문제**
    - 대부분의 컴포넌트들이 CSR로 이루어져 초기 로딩 속도가 김. state 변경에 따른 불필요한 리렌더링이 발생과 그로 인한 불필요한 API호출.
- ### **안좋은 UX**
    - 이벤트 찜 버튼은 로그인 하지 않으면 사용할 수 없지만 동작할 것 처럼 나타남. 사용자에게 혼란을 줌.
    - 회원가입, 로그인 실패 시 실패 이유 피드백이 오지 않음.
    - 이벤트 페이지에서 뷰 모드에 따라 제공되는 정보가 일관적이지 않음.
 
      
# challenge

> SOLID 원칙을 기반으로 접근함. 각 컴포넌트와 로직의 책임을 명확히 하고 확장성이 높고 유지보수하기 쉬운 코드 구조를 목표로 삼음.
> 
- ### **중복 코드 문제 해결**
    - 증복된 API 호출 로직을 공통 함수로 구현. fetch API는 변경 가능성이 높다고 판단하여 Adapter패턴을 적용.
    - 백엔드와 API 응답 코드를 정의해 두어서 응답 처리를 공용화 할 수 있다고 판단. 상태 코드별로 핸들링하는 공용 함수를 생성.
    - form컨트롤 로직을 재사용 가능하도록 custom hook으로 생성.
            
- ### **확장성과 재사용성 향상**
    - 커스텀 훅의 재사용성이 떨어지는 이유를 하나의 훅이 너무 많은 기능을 처리하고 있어서라고 판단. 하나의 hook은 하나의 기능만을 담당하도록 변경.
            
    - 동일 데이터, 다른 레이아웃 UI가 필요한 컴포넌트에 CCP 디자인패턴을 적용.
            
- ### **비효율적인 API 호출 최소화**
    - 로그인 유무 검사를 API를 호출이 아닌 state로 할 수 있다고 판단. Context API로 로그인 상태를 전역으로 관리.
    - 찜한 아이템 리스트를 Context로 관리. 페이지를 리로드 할 경우에만 `getMyLikes()`  API 로 데이터 mutate.
- ### **성능 향상 및 보안 강화**
    - 가능한 데이터 패칭 로직을 SSR로 구현하고, 하이브리드 렌더링 적용.
        - SSR 접근을 위해 토큰 저장소를 Cookie로 변경.
        - 토큰 저장소는 추후에 세션, 로컬스토리지 등 다른 저장소로 바뀔 수 있다고 판단. 토큰 저장 로직에 Adapter패턴 적용.
    - 접근 권한 검사를 클라이언트 측에서 하는건 보안상 좋지 않다고 판단. middleware에서 검사하도록 변경.
- ### **UX 개선**
    - 찜 버튼에 권한 검사를 추가. 권한 유무에 따라 스타일링을 구분.
    - 회원가입, 로그인 실패 시 UI에 피드백이 노출되도록 변경.
    - 이벤트 페이지의 뷰 모드는 UI모드일 뿐 데이터에는 변경이 없어야 한다고 판단. 맵 뷰에 페이지 네이션을 추가해서 데이터 통일.


# to-be

- 중복 코드를 줄이고 공통함수 및 디자인 패턴을 적용하여 코드의 재사용성과 유지보수성을 향상시켰다.
- 전역 State 관리 기술을 도입하여 불필요한 API 호출을 줄이고 서버 부하를 방지하였다.
- 명확한 피드백 제공, 일관된 데이터 제공 등으로 사용자의 혼란을 최소화하여 UX를 개선시켰다.
